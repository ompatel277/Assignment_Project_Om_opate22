{% extends "accounts/base.html" %}
{% load static %}

{% block title %}GitHub Profile Search — Traject{% endblock %}

{% block content %}
<div class="container mt-5">

 <!-- Header -->
 <div class="text-center mb-5">
 <h2 class="fw-bold text-accent mb-3"><i class="bi bi-laptop"></i> GitHub Profile Search</h2>
 <p class="text-light">Search GitHub user profiles to explore developer portfolios</p>
 </div>

 <!-- Search Form -->
 <div class="card mb-4" style="background: rgba(255, 255, 255, 0.05); border: 1px solid var(--tj-accent);">
 <div class="card-body">
 <form method="GET" class="row g-3">
 <div class="col-md-10">
 <label class="form-label text-accent">GitHub Username</label>
 <input
 type="text"
 name="username"
 value="{{ username }}"
 class="form-control"
 placeholder="e.g. torvalds, gvanrossum, octocat"
 required
 >
 </div>

 <div class="col-md-2 d-flex align-items-end">
 <button type="submit" class="btn btn-primary w-100">Search</button>
 </div>
 </form>

 <div class="mt-3">
 <small class="text-muted">
 <i class="bi bi-lightbulb-fill"></i> Try: "torvalds", "gvanrossum", "tj", or any GitHub username
 </small>
 </div>
 </div>
 </div>

 <!-- Navigation -->
 <div class="mb-4">
 <a href="{% url 'accounts:dashboard' %}" class="btn btn-outline-secondary">← Back to Dashboard</a>
 {% if username and user_data %}
 <a href="?username={{ username }}&format=json" class="btn btn-outline-info" target="_blank">
 <i class="bi bi-graph-up"></i> View JSON
 </a>
 {% endif %}
 </div>

 <!-- Error Message -->
 {% if error %}
 <div class="alert alert-danger">
 <strong> Error:</strong> {{ error }}
 </div>
 {% endif %}

 <!-- User Profile Results -->
 {% if user_data %}
 <div class="row g-4">

 <!-- Profile Card -->
 <div class="col-md-4">
 <div class="card h-100 text-center" style="background: rgba(255, 255, 255, 0.05); border: 2px solid var(--tj-accent);">
 <div class="card-body">
 {% if user_data.avatar_url %}
 <img
 src="{{ user_data.avatar_url }}"
 alt="{{ user_data.username }}"
 class="rounded-circle mb-3"
 style="width: 150px; height: 150px; border: 3px solid var(--tj-accent);"
 >
 {% endif %}

 <h4 class="text-accent mb-2">{{ user_data.name }}</h4>
 <p class="text-muted mb-3">@{{ user_data.username }}</p>

 {% if user_data.bio != 'No bio available' %}
 <p class="text-light mb-3">{{ user_data.bio }}</p>
 {% endif %}

 <a href="{{ user_data.html_url }}" target="_blank" class="btn btn-primary btn-sm">
 <i class="bi bi-link-45deg"></i> View on GitHub
 </a>
 </div>
 </div>
 </div>

 <!-- Stats & Info -->
 <div class="col-md-8">

 <!-- Stats -->
 <div class="card mb-3" style="background: rgba(255, 255, 255, 0.05);">
 <div class="card-body">
 <h5 class="text-accent mb-3"><i class="bi bi-graph-up"></i> GitHub Stats</h5>
 <div class="row text-center g-3">
 <div class="col-4">
 <h3 class="text-warning mb-0">{{ user_data.public_repos }}</h3>
 <small class="text-muted">Public Repos</small>
 </div>
 <div class="col-4">
 <h3 class="text-info mb-0">{{ user_data.followers }}</h3>
 <small class="text-muted">Followers</small>
 </div>
 <div class="col-4">
 <h3 class="text-success mb-0">{{ user_data.following }}</h3>
 <small class="text-muted">Following</small>
 </div>
 </div>
 </div>
 </div>

 <!-- Additional Info -->
 <div class="card" style="background: rgba(255, 255, 255, 0.05);">
 <div class="card-body">
 <h5 class="text-accent mb-3">ℹ Profile Information</h5>

 {% if user_data.location != 'N/A' %}
 <p class="mb-2">
 <strong class="text-warning"><i class="bi bi-geo-alt-fill"></i> Location:</strong> {{ user_data.location }}
 </p>
 {% endif %}

 {% if user_data.company != 'N/A' %}
 <p class="mb-2">
 <strong class="text-info"><i class="bi bi-building"></i> Company:</strong> {{ user_data.company }}
 </p>
 {% endif %}

 {% if user_data.blog != 'N/A' %}
 <p class="mb-2">
 <strong class="text-success"><i class="bi bi-globe2"></i> Website:</strong>
 <a href="{{ user_data.blog }}" target="_blank" class="text-accent">{{ user_data.blog }}</a>
 </p>
 {% endif %}

 {% if user_data.twitter_username != 'N/A' %}
 <p class="mb-2">
 <strong class="text-primary"><i class="bi bi-twitter"></i> Twitter:</strong> @{{ user_data.twitter_username }}
 </p>
 {% endif %}

 <p class="mb-0">
 <strong class="text-muted"><i class="bi bi-calendar3"></i> Joined:</strong> {{ user_data.created_at|slice:":10" }}
 </p>
 </div>
 </div>
 </div>
 </div>

 <!-- Top Repositories -->
 {% if repos %}
 <div class="mt-4">
 <h5 class="text-accent mb-3"><i class="bi bi-folder-fill"></i> Recent Repositories</h5>
 <div class="row g-3">
 {% for repo in repos %}
 <div class="col-md-6">
 <div class="card h-100" style="background: rgba(255, 255, 255, 0.05); border-left: 3px solid var(--tj-accent);">
 <div class="card-body">
 <h6 class="card-title text-accent mb-2">
 <a href="{{ repo.html_url }}" target="_blank" class="text-accent text-decoration-none">
 {{ repo.name }}
 </a>
 </h6>

 {% if repo.description != 'No description' %}
 <p class="small text-light mb-2">{{ repo.description }}</p>
 {% endif %}

 <div class="d-flex gap-3 align-items-center">
 {% if repo.language != 'N/A' %}
 <span class="badge bg-primary">{{ repo.language }}</span>
 {% endif %}
 <small class="text-muted"> {{ repo.stars }}</small>
 <small class="text-muted"> {{ repo.forks }}</small>
 </div>
 </div>
 </div>
 </div>
 {% endfor %}
 </div>
 </div>
 {% endif %}

 {% elif username %}
 <div class="text-center py-5">
 <p class="text-muted">No results found. Try a different username!</p>
 </div>
 {% else %}
 <div class="text-center py-5">
 <p class="text-muted">Enter a GitHub username to start searching</p>
 </div>
 {% endif %}

 <!-- API Information -->
 <div class="mt-5 p-4 rounded" style="background: rgba(255, 255, 255, 0.05);">
 <h5 class="text-accent mb-3"><i class="bi bi-broadcast"></i> API Information</h5>
 <p class="text-light mb-2"><strong>Data Source:</strong> GitHub REST API v3</p>
 <p class="text-light mb-2"><strong>Endpoint:</strong> <code>https://api.github.com/users/&lt;username&gt;</code></p>
 <p class="text-light mb-0"><strong>Rate Limit:</strong> 60 requests per hour (unauthenticated)</p>
 </div>

</div>
{% endblock %}